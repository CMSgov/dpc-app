version: "3"

services:
  api:
    image: ${ECR_HOST:-755619740999.dkr.ecr.us-east-1.amazonaws.com/dpc-api-go}:latest
    build:
      context: .
      dockerfile: docker/Dockerfiles/Dockerfile.api
    volumes:
      - /tmp:/tmp
    ports:
      - "3000:3000"
      - "3011:3011"
    environment:
      - DPC_PUBLIC_PORT=3000
      - DPC_ADMIN_PORT=3011
      - DPC_ATTRIBUTION-CLIENT_URL=http://attribution2:3001
      - DPC_SSAS-CLIENT_ADMIN-URL=http://ssas:3004
      - DPC_SSAS-CLIENT_PUBLIC-URL=http://ssas:3003
      - DPC_SSAS-CLIENT_CLIENT-ID=31e029ef-0e97-47f8-873c-0e8b7e7f99bf
      - DPC_SSAS-CLIENT_CLIENT-SECRET=
      - DPC_APISCOPE=dpcv2-api
      - DPC_CERT=LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURVVENDQWptZ0F3SUJBZ0lKQUtuejBlWElLL2Z3TUEwR0NTcUdTSWIzRFFFQkN3VUFNRkl4Q3pBSkJnTlYKQkFZVEFsVlRNUXN3Q1FZRFZRUUlEQUpEUVRFVE1CRUdBMVVFQnd3S1RHOXpRVzVuWld4bGN6RU5NQXNHQTFVRQpDZ3dFUVVOTlJURVNNQkFHQTFVRUF3d0piRzlqWVd4b2IzTjBNQjRYRFRJeE1Ea3hOREUwTURZME9Wb1hEVEl5Ck1Ea3hOREUwTURZME9Wb3dWakVMTUFrR0ExVUVCaE1DVlZNeEN6QUpCZ05WQkFnTUFrTkJNUk13RVFZRFZRUUgKREFwTWIzTkJibWRsYkdWek1SRXdEd1lEVlFRS0RBaEJRMDFGSUVGUVNURVNNQkFHQTFVRUF3d0piRzlqWVd4bwpiM04wTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUFxaDhBelJtcStNdmZWQlZCCkoxdnRoeVN0bGsybWwwSzQyY1JwdkRDdGNtRGNRZ213RUV0dGxHNzVQVEtsREhrb241djQ4a3ZyV2I5Q3FtNG8Kd0U3M0lHMXEzMDlKU0ExQ1gyTDN3TE1kTDlUL2w2S1I2YjRpV1NnWXJyZXdxSlA0aE15WHJwa0N1MEk5Q1I2RQpLeE9aejloUk5EWThmUmZ6YW9vSlNYRnNiUWRlN0tBaVc0U045RVJXVjZrZjlBa3I1VTBhdGJoOVRFWE9JKzk4CmhOQjJBVVIyOWlBL1RpdXFURk1KRklhNEFicGg0VmxlMXpXSEVOZkswTmdXQ3pma2lKd2hzOVJrdXhHdGs3RU0KWFlnUm9ZYU9tT3JkWGNZQTcrMFBQcEJUYnVrWHllNHYzUUFXM1E3T3lOODQ1bmx5aFU0YW1NSENtQ2s3UUVaOQpFMFl4QVFJREFRQUJveVl3SkRBVUJnTlZIUkVFRFRBTGdnbHNiMk5oYkdodmMzUXdEQVlEVlIwVEJBVXdBd0VCCi96QU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFFSXhCcjVwcWhUWTRoODFpNUc3Q1BvU29SVUd6WVU4Nk4zRk4KV0lFc2t6Q1J2bE83VFJKM0xyWTJMTGJtR0p6OWx5MzRjS3BtM3ZEM0JYb2J3VUh4K1gwYWZTaGxrNEI0eitJWgp6dWthSHU4SWc4RnV3OG1zZWpTSUZwcDJCSzVtRGVNQmgxcEhnUGkxMDh6WjY1RmoyMnlBUWdMWm5uWEU0cmRUClZLU2p0aFNTanQ0cnBZVHpEbkI5eEpHRDR2TmpxK3R2OGcxV2tuc0F0cDVKbHZWbnhHNVNFQ2ZPS2FEQkRMTnUKbWFvT05JbEtpaWNlT0JlQldlL25EV0crNTh4S090Q09aQmNhSGtKUVFJR2ZtbDJ2c2E4d29aSW1BS3htZU5WOQp0UTRJcWZ5QStMRWR2YWZBS0JVbEQ1Y0JPNzFMREE4eS9FdFZNZ0lLYkJPVVU3M3Fkdz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
      - DPC_CERT_KEY=LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBcWg4QXpSbXErTXZmVkJWQkoxdnRoeVN0bGsybWwwSzQyY1JwdkRDdGNtRGNRZ213CkVFdHRsRzc1UFRLbERIa29uNXY0OGt2cldiOUNxbTRvd0U3M0lHMXEzMDlKU0ExQ1gyTDN3TE1kTDlUL2w2S1IKNmI0aVdTZ1lycmV3cUpQNGhNeVhycGtDdTBJOUNSNkVLeE9aejloUk5EWThmUmZ6YW9vSlNYRnNiUWRlN0tBaQpXNFNOOUVSV1Y2a2Y5QWtyNVUwYXRiaDlURVhPSSs5OGhOQjJBVVIyOWlBL1RpdXFURk1KRklhNEFicGg0VmxlCjF6V0hFTmZLME5nV0N6ZmtpSndoczlSa3V4R3RrN0VNWFlnUm9ZYU9tT3JkWGNZQTcrMFBQcEJUYnVrWHllNHYKM1FBVzNRN095Tjg0NW5seWhVNGFtTUhDbUNrN1FFWjlFMFl4QVFJREFRQUJBb0lCQUFETXJJQktRcGR3dmRmegpVWjhSdTRnTEVCWEl2Nk91V0pnTmFFSE9LTUtFMmdRbGI0SmtHRnUrT2NXajIwcTN0dzBvK242SkJNNGpLL2tKCkUzL3ozdzF6OWpDZWVzV3Y2a1B3ZnlHVXRlcG5vZHZnazdiNWdjZlJmR3cxeU1yQ0IwVDRnUzM4NGhwbk1VbzkKcm5sVldqK3owSTNpUTE2RElrMjU0RmxNQXlwd0FIZ0pMN0kwWkVTUnk3L3R4SFpUbnNPdkEraEJ2czczY1FjZwpOZjhGRjNHT0NBZlJCOGhUQkQ5WWgrOGVLOEpLVWhhTXdZdVNIcXU3NkV6UmtMeE56TlNBNXJ1WWxnN0hNS1luCjZXUytGbmtKc1JDamNoZUFaWncyTy9Vdkt5SUp1VmtlbUZQSUJENUh1bCtXb2ZzSU9LOEkrcDVIeGNMVWdzb1oKazY4MFh4RUNnWUVBMGc4S3VtdVY0cndENFFVNjJMTm51RVlIYitxZnBqVGd6K09jdUVheFZtT0FKR09TUkdXZQowNGlUOTVENit0VmxSTFc5MFRwdjl4NTl5T1QzUmxkNlZlckEreEEyTEVYbjR3UFVGcElWTmhIaTl0ZERQdC9VCmpyNldueGlPYzFoV2gzb0gxU0dQNFo4QWNBUSsySG1ieWs4WXRJSm95QTIwZWVsbHpMOTZUWE1DZ1lFQXoxUGwKYThTamVJejZYL0RCRWZxK2Q0YUZMUStLcC9SSEUyUGRlR29ad0ZObDZmaTgyOXcvNVd5b1pPd3ZsT1RKS2I3YQpwSjBNMTR4MzVyaDFJVVByS1BZdTV3NlMzemhJTUlJWkxjVTYvWWphWFV6ZDNva3NYYjBhYy9UZENrNWhOQzZ6ClNDSTNxd1dQZlVJZ3ZDSGtpdWhiNjdDZXd5N05MT0kxcGJRcWFyc0NnWUI1cjJjS21UcHA3M3JieHRqUkloVEsKcGg2MjBaY01oSU5iU3NMRjZZWGZ3cUkvOGtLUVJzSWNUbmxSSi9hTWlrUXc2b3Q4Z2pyTVVDaVQwVGdCMHJrMgp2bGh1MkhSWmIyR21tOWduL3hZMGpXWUtrcWNNN0VOSk1kVTFjdGRLc0hqbjRHUmJMaWNZajdDRU02Rm9iQUk0CnoxdERibXhldjdtMkNlUUVHVVF6U3dLQmdRQ0hsM25LZ2w3YTMzQjd3R3UwZzRWL2pDV2E4N2dkNGI5K0tlalUKOEtjSXhrSTN3NnBZSy9KSjdFY3hRZHBZaVV3YWxpeE9UanZ3MkhndUYyTGJMNTBqTytZdXpMUTNjb3FiMXVuNgpxaXZMVm01aGFIME9KaTR5M0JMcDFUR2VwT1lqaDR0TzJMb0ppbWh1WmdvY29CbmswdFFURDM2MWJlMVh0bFdaCm1udkhNd0tCZ0FtQ2tUQmQ4L1RpZXB6c2lYNktGM25QKzhtUzdXMW9rdUJIR0tacHRPdGgvUnVBbUZaZm41NWMKV1FMZTN4VnYzYjBib21VeHZ0UVJ3UHlud0tESWovbEJPc3dBZjFnRmNlTFV2K1RBQXVwdHBwZFAzTXRhb3I0dQpxZzJpRmxZWGhsNktVUmwrUDNGN2VOdWgzUk53aEgwbk1DN21nV1dTdk1DWVN3ZHBOMkhNCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==