version: "3"

services:
  attribution2:
    image: ${ECR_HOST:-755619740999.dkr.ecr.us-east-1.amazonaws.com/dpc-attribution-go}:latest
    build:
      context: dpc-go/dpc-attribution
      dockerfile: docker/Dockerfiles/Dockerfile.attribution
    ports:
      - "3001:3001"
    environment:
      - DPC_BFD_CLIENTCERTFILE=/app/shared_files/decrypted/bfd-dev-test-cert.pem
      - DPC_DB_URL=postgresql://postgres:dpc-safe@db:5432/dpc_attribution_v2
      - DPC_DB_URLV1=postgresql://postgres:dpc-safe@db:5432/dpc_attribution
      - DPC_DB_QUEUEURL=postgresql://postgres:dpc-safe@db:5432/dpc_queue
      - DPC_PORT=3001
      - DPC_CA_CERT=LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURJRENDQWdnQ0NRRFl4YzZmUmVKSXpEQU5CZ2txaGtpRzl3MEJBUXNGQURCU01Rc3dDUVlEVlFRR0V3SlYKVXpFTE1Ba0dBMVVFQ0F3Q1EwRXhFekFSQmdOVkJBY01Da3h2YzBGdVoyVnNaWE14RFRBTEJnTlZCQW9NQkVGRApUVVV4RWpBUUJnTlZCQU1NQ1d4dlkyRnNhRzl6ZERBZUZ3MHlNVEE0TURNeU1ERXpNREphRncweU1qQTRNRE15Ck1ERXpNREphTUZJeEN6QUpCZ05WQkFZVEFsVlRNUXN3Q1FZRFZRUUlEQUpEUVRFVE1CRUdBMVVFQnd3S1RHOXoKUVc1blpXeGxjekVOTUFzR0ExVUVDZ3dFUVVOTlJURVNNQkFHQTFVRUF3d0piRzlqWVd4b2IzTjBNSUlCSWpBTgpCZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUF5eWx4Y0lzZUV0ckVqZ1I1QWNhK3ZPenpDYzRiCk91TUxaazVVcnJnQWI2Qy9yNGFWQzN1bVlOUTNtd2J5eGhwYjUwNUd4dHdDZ0hCR0tpMzB2Q1AzNWtqbjFyZG4Ka3B3V2J2aWJTR0NyV2xQc0hBSHFBSnhtaTFjL1ozVlFSRnh5bm52dXQ4L0ZEditpWW9BdVAzM3QyTzhWMTlaVgpJRzY0bTZVSFYzckh1V1RmMDN3Vk1IQzNNSlUxTjVZM0IvVCsxUjRwNGl4R2laRUhQVFJGMzlEenlDK1ZyYjRjCklCSXZxd3cyUk5MMHFZdGpRVmFMendOVmhrRXFTblhBODhTZ0p3TG1hTWh3dkczQktGQ245c2dXVDBoeFNGOTYKNWVvbVA3enU3QW5xbVFsUXBaUmEwR2cvS01IYytUYXMzN2dwL3MvTVZKSDlrNjNneXRvQ3l6U2ZYd0lEQVFBQgpNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUFhM1lZRCt4MjlMblllTXNnbGt0amlyQmZpMlJSeGdiQkh6VXQ5Ci9xa3dvVEQ4dGdEQnFRenhJNXhOY0QzblhPOUIwMTVBRms2ems5TUFLL2dwSkJTWk9HUGRhaHhBVXI3SGkvdWEKczQyNU56ZEczN29HaTkyaXZjLzc3M2t4YmxQK0xWczBjekMvWElqVExDaGtzVVN3ZEU3VTRiZGpMZk9Sa2p6VApVTnhkUktReHpCcElWL0FXRnk1VlMrQXZPaC82QngzRDlZdFVaMUZJTWlmdHUvbnptaENBMCszQURSMnlVTGo3CnFMblNpQXMrajh6R09iS1FtWFdMdGlUcjAraCtUeDdlS1Y2S1krN3pCNXJSY1hsZlFkMVNGWUlwR3E3Tk00eDgKTmVXZ0xoc3YrVFYyUjVEdC9oMGhvREMyNDFDRmdGTU9sb3ZHT2pNTUFqeUoxUkJMCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
      - DPC_CERT=LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURZekNDQWt1Z0F3SUJBZ0lKQU85czJDTnBET1dnTUEwR0NTcUdTSWIzRFFFQkN3VUFNRkl4Q3pBSkJnTlYKQkFZVEFsVlRNUXN3Q1FZRFZRUUlEQUpEUVRFVE1CRUdBMVVFQnd3S1RHOXpRVzVuWld4bGN6RU5NQXNHQTFVRQpDZ3dFUVVOTlJURVNNQkFHQTFVRUF3d0piRzlqWVd4b2IzTjBNQjRYRFRJeE1EZ3dNekl4TVRNMU1Gb1hEVEl5Ck1EZ3dNekl4TVRNMU1Gb3dWekVMTUFrR0ExVUVCaE1DVlZNeEN6QUpCZ05WQkFnTUFrTkJNUk13RVFZRFZRUUgKREFwTWIzTkJibWRsYkdWek1SSXdFQVlEVlFRS0RBbEJRMDFGSUVGMGRISXhFakFRQmdOVkJBTU1DV3h2WTJGcwphRzl6ZERDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTEgvR29aUEhmYjJFcHFpCmMyUVQvQU9WYWkxdUtoRlVzQlVzcnJNd3MvM1JIUmpMc1pFZ0pzYTVVaUlod1RXK2FrZ0E4WjY2QkdKWFB1VWkKS3ZoOHZKUkJpRHBtemllVWFVbng1QTRnQWtiSEZPZzkzSXptdDltL09tK3BLNzNPbmNTOUV2STUxTmU1c04xVwpPRDVKbG5SSUhweW5sOG5Td3NjOU5tSFlVMjh6RzRXZ1dNcTFuaGFrUkI5ekdjQTZ1Rm9FNmc2SDJWaWNhQ1ZzCnhkOUIxMU1ROGx5MkpqTHZGYjJ5cmJHUW9aYzVLNlF3Z2c2TzFmSHF3KzI3OWlOdjh3WWFMQ2hhSXl6Q01hbi8KYzd3WnVFQWtWODBMWEN0K2IrVTBQSVVwRSt2VmZ5ZkhSLzN6N0lIdkZiaUVlbHgyKzhWcEhoeTNYZXIyZGZJdwpOaWhWajY4Q0F3RUFBYU0zTURVd013WURWUjBSQkN3d0tvSUpiRzlqWVd4b2IzTjBnaDFzYjJOaGJDNWhkSFJ5CmFXSjFkR2x2Ymk1a2NHTXVZMjF6TG1kdmRqQU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUF1QSsvUmlDL1djYSsKSGk4bTB0RTdzTWdvVS9hOTdzTlR4cUNSWGE1Wm9xcHZJTjJEMklPRHJsK0YvRit3a1IrRklGVjlwaFRRRXVGcAptQ3dkZFNCUHB2anQvVHRidnhVbzlYYTk0eWRsRCtOQ0VRQ2ZSYUxQT215QkdhNmZJb09pQ05PZlhZQmRycEp1CmUvOUdhYm4vclJ6TDRZUDRtMEszaFcxOUpPWnVKeVo1Y3o4WlFhT2F1aDBzNmpNd3JvaTVlSyt4cXBVUUNFZFcKRXIvQy9JTXJmb2V1N3dLaHRhZ1N3YXFlUzRQTWI1UmhmcTR2cTJteng2Mmg3SnRNVVdJTTFwTXNjU2pVMXVPTQpDUURJNGU4aWlMZG9hNm1QRE40NW51SFlMUTAxdmQ0bDVtc0JLbS9zT1pjS0grdFJYeURFUEZrWDMxUzFiQkQ2ClpEZXFQcWtiaGc9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
      - DPC_CERT_KEY=LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBc2Y4YWhrOGQ5dllTbXFKelpCUDhBNVZxTFc0cUVWU3dGU3l1c3pDei9kRWRHTXV4CmtTQW14cmxTSWlIQk5iNXFTQUR4bnJvRVlsYys1U0lxK0h5OGxFR0lPbWJPSjVScFNmSGtEaUFDUnNjVTZEM2MKak9hMzJiODZiNmtydmM2ZHhMMFM4am5VMTdtdzNWWTRQa21XZEVnZW5LZVh5ZExDeHowMllkaFRiek1iaGFCWQp5cldlRnFSRUgzTVp3RHE0V2dUcURvZlpXSnhvSld6RjMwSFhVeER5WExZbU11OFZ2Ykt0c1pDaGx6a3JwRENDCkRvN1Y4ZXJEN2J2MkkyL3pCaG9zS0ZvakxNSXhxZjl6dkJtNFFDUlh6UXRjSzM1djVUUThoU2tUNjlWL0o4ZEgKL2ZQc2dlOFZ1SVI2WEhiN3hXa2VITGRkNnZaMThqQTJLRldQcndJREFRQUJBb0gvYlNrR0cxaHFDQXJoWGZSQwowQjF4Y01FeFhLc3pJVzNPankzWDlnem9WY0RwRjB2VW1pd2RtOElMbk9NV210OHNUdnhGTWhMaW5XemtKYUhPCnVKWEhFU1VmWnJHbHZLQkg4aEZteTBMV0lwSDFRSGl2eWJtMUJ0VkFBVHErbUtrZUdJbmNGTEZpMXVvS2piTlMKeXVCV1pQblZ6RHo3MmNwbnFjamdrU0VhQ2hkSFAvc0w4WHZPZFp6SXpKdzVyNlJkN2xPZGtWcGpta3IrUTQ1eAp0MnBFMmhlK1diVE9CYU1UbVovaFNMeVNKaGVoYkZvNXl3a0l2YldWZFhUNjhwUEFQOXZRWmJ3cFA4WlNucVhlCldoU0JYb2xzN2VLS0FBNXBLeGs3TjBLblN2dG1zTFQyNytUbTJBT2F1NitncmZPbm15ekpqTDRodkhOaW1JWXcKczI5SkFvR0JBT1hIRlF0SkNTd3ZmMzUzNkYxdmdkenNpUDdzTGhDYU9vQXdWVzB0NEZvQmJYRDlsclh2VnMrVQpWRTJqaFZlelZud2grSi9DZjNYUjJRQmRMUW1YQUFhSnJCWWpRYnB6cFgvREorRHZVWklHTHpMT0FtS2JreFYyCnFFZitlUEpnQVlzVFdQMTBwSUpkWHFvVlAzQ1BQVWJvcXg5amduV1N2OVRvWU45d3d4WVZBb0dCQU1aUFBpNm0KVCtrSEVuQXhmMGdQdHlQZWZrbmhMZFE2MHhNVExRVVd0S3dyaTdUVHltVkxCdjRIblM5SlhxOHNMZzA5d3c0VgowMU55QkRDSitESUE3Zmd1ekk1RHl0eUZDZE9BS2UrK01MMGpENUY4RlVGK3BKR0JTSE15dWlDazRYODJmeWpmCjlmN3p5TUo0WnJFbmw3d2ErMUN6YzJOOHhFcUt4ZWQ0bDJPekFvR0JBS1lXL1hNbTIrYUFmdHZmdUtxeFMyRngKNktTNys2QXNtMVRGbXpwTUN2dUVSS09ENmtpZ05GUGZtQUIyem8vU0poV2NTS2JTWkdlNXcrMnJiRDZlVTNwbQpVV20vR21lMzZFMHR0OG16czNhbDJjQVRnVTNkdnJlcENZTGd3blFRU1kxSjh1MWlQdmVzbmh5N054d1pyZVZ2CmtTSWpQODNVd2EwWU84M0hLSHp4QW9HQkFJK29rQzlUSThoMzZ3K0RpK1UwSFVQS3hrblc2bEE0WFBnUWlDaUwKams2N0xQWE9CMnpoc1NzTmNQejBkYmNJbGtQWlhoZ3lEMmoveTdFdUFiS1hvY3lNZW5zRStVeE94Qk9IWU5uZwpPWWFLZzVpcy91ajNTVmh2QTRFUVdtMlRoQmVYN3Y0NVlBZFZxelhWNnU2aTgvUzh4eHBySlVnSTlsblp0Z3c4Cis4NnBBb0dCQU9DY2h0MkYvL2VNbk05REd6Vk9JbkgvL0NoMkFzRVU1dHFYVHlVZjNEU2RLeVQ1d1NIK00yK3AKOW1id2NVdVorQzllQUF6WUpXYlVHVVNCUmZmQWVxWGNGVXh5OHJybVBSRFNQalVBOG1wTkcvd3NKVnlSUWFYUApqV3RMOVN4SU9qdzBMTlRDNUg0MVdiU2xJbDE4Mjk5MFcwWHBUeDV0TFdCY1lsV0Qyb2VGCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==
    volumes:
      - ./dpc-go/dpc-attribution/shared_files/decrypted:/app/shared_files/decrypted
